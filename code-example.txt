export const useAudio = () => {
  const resource = Resource.get()
  const [audioList, setAudioList] = useState<Record<string, HTMLAudioElement>>({})
  let audioEnabled = useAppSelector(SettingsSelectors.getAudioEnabled)

  const createAudio = (name: string) => {
    const audioType = name.split('.')[0] as TAudio
    if (Object.keys(AudioVolume).includes(audioType)) {
      const audio = getValue(resource.audio, name) as HTMLAudioElement
      audio.muted = false
      audio.volume = AudioVolume[audioType] / 10
      audio.loop = audioType === 'music'

      const list = audioList
      list[name] = audio
      setAudioList(list)
    } else {
      console.warn('Wrong audio name:', name)
    }
  }

  const playAudio = (name: string) => {
    if (!audioEnabled) return
    if (!audioList[name]) createAudio(name)

    if (!Object.keys(audioList).length || !audioList[name]) return

    audioList[name].play().catch((e: Error) => {
      console.warn(e.message)
    })
  }

  return playAudio
}
